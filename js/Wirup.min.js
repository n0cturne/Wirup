"use strict";var wirup=function(){};wirup.prototype=function(){var _getElement=function(e){return document.getElementById(e)},_wijax=function(e,t,a,n){var o=new XMLHttpRequest;return o.open(e,t,!0),o.setRequestHeader("Content-Type",a),o.setRequestHeader("cache-control","max-age=0"),o.setRequestHeader("expires","0"),o.setRequestHeader("expires","Tue, 01 Jan 1980 1:00:00 GMT"),o.setRequestHeader("pragma","no-cache"),o.onload=n,o.send(),o.responseText},_routes={},_viewTemplates,_appLocation=window.location.hash.split("#")[1],_registerTemplates=function(){_wijax("GET","templates/templates.json","application/json; charset=UTF-8",_getTemplates)},_templateHolder="",_setTemplateHolder=function(e){_templateHolder=e},_getTemplates=function(){_viewTemplates=JSON.parse(this.responseText).templates},_getTemplate=function(e){var t,a=_appLocation;void 0===_appLocation&&(window.location="/#/");for(var n=0;n<=_viewTemplates.length-1;n++)_viewTemplates[n].url==a&&(t=n);_fillTemplate(t,e)},_fillTemplate=function(e,t){_wijax("GET","templates/"+_viewTemplates[e].HTML,"text/plain; charset=UTF-8",function(){_getElement(t).innerHTML=this.responseText})},_bindRouter=function(){window.onhashchange=function(){window.location.hash!=_appLocation&&(_appLocation=window.location.hash.split("#")[1],_init())}},_components=[],_registerComponent=function(e){for(var t,a=0;a<=_components.length-1;a++)_components[a].componentName==e.componentName&&(t=a);void 0!=t&&null!=t?_components[a]=e:_components.push(e)},_renderComponents=function(){for(var e,t=0;t<=_components.length-1;t++){e=document.getElementsByTagName(_components[t].componentName);for(var a=0;a<=e.length-1;a++)void 0!=e[a]&&null!=e[a]&&(e[a].innerHTML=_components[t].HTML)}},_getDataObjectType=function(e){return Array.isArray(e)?"array":typeof e},_baseDataTemplates=[],_dataModels=[],_dataValuesModels=[],_setBaseDataTemplate=function(e,t){for(var a=!1,n=0;n<=_baseDataTemplates.length-1;n++)_baseDataTemplates[n].templateName==e&&(a=!0);a||_baseDataTemplates.push({templateName:e,templateHTML:t})},_getBaseDataTemplateHTML=function(e){for(var t,a=0;a<=_baseDataTemplates.length-1;a++)_baseDataTemplates[a].templateName==e&&(t=_baseDataTemplates[a].templateHTML);return t},_setDataModel=function(e,t,a){for(var n=!1,o=0;o<=e.length-1;o++)e[o].dataModelName==a&&(n=!0,e[o][t]=a);n||e.push({dataModelName:t,dataObject:a})},_dataSnapShot=[],_watchDataModel=function(){setInterval(function(){for(var e=0;e<=_dataModels.length-1;e++)_dataSnapShotList.length<_dataModels.length&&(_dataSnapShotList[e]=JSON.stringify(window[_dataModels[e].dataModelName])),_dataSnapShotList[e]!=JSON.stringify(window[_dataModels[e].dataModelName])&&(_dataSnapShotList[e]=JSON.stringify(window[_dataModels[e].dataModelName]),_bindDataLists())},500)},_watchDataValuesModel=function(){setInterval(function(){for(var i=0;i<=_dataValuesModels.length-1;i++)eval(_dataValuesModels[i].dataModelName)!=_dataValuesModels[i].dataObject&&(_dataValuesModels[i].dataObject=eval(_dataValuesModels[i].dataModelName),_bindDataValues())},500)},_bindDataValues=function(){for(var _dataValueElements=document.querySelectorAll("[data-value]"),_subElementsArray=[],_temporaryElement,i=0;i<=_dataValueElements.length-1;i++){var _dataObjectName=_dataValueElements[i].getAttribute("data-value");_temporaryElement=document.createElement(_dataValueElements[i].tagName),_dataValueElements[i].innerHTML=eval(_dataObjectName),_setDataModel(_dataValuesModels,_dataObjectName,eval(_dataObjectName));var _mutationUICallback=function(mutationsList){for(var i=0;i<mutationsList.length;i++)eval(_dataObjectName+'="'+_dataValueElements[i].innerHTML+'"')},_DataValuesUIObserver=new MutationObserver(_mutationUICallback);_DataValuesUIObserver.observe(_dataValueElements[i],_mutationObserverConfig)}},_bindDataLists=function(){for(var e,t=document.querySelectorAll("[data-list]"),a=[],n=0;n<=t.length-1;n++){var o=t[n].getAttribute("data-list");e=document.createElement(t[n].tagName),_setDataModel(_dataModels,o,window[o]),_setBaseDataTemplate(o,t[n]),a=_renderDataList(o,t[n]);for(var s=0;s<=a.length-1;s++)e.appendChild(a[s]);e=_reassignAttributes(t[n],e),t[n].parentNode.replaceChild(e,t[n])}},_reassignAttributes=function(e,t){for(var a=e.attributes,n=a.length-1;n>=0;n--)t.setAttribute(a[n].name,a[n].value);return t},_renderDataList=function(e,t){var a=_getParseableDataObject(e);window[e]=a;var n=_getBaseDataTemplateHTML(e);return document.createElement(n.tagName).className=n.className,_buildSubElements(a,e,n)},_buildSubElements=function(e,t,a){var n,o=[];switch(_getDataObjectType(e)){case"object":for(var s=0;s<=e[t].length-1;s++){var r=e[t][s];n=_parseDataKeys(t,r,s,a.childNodes[1]),o.push(n)}break;case"array":for(s=0;s<=e.length-1;s++)n=_parseDataKeys(t,null,s,a.childNodes[1]),o.push(n)}return o},_getParseableDataObject=function(e){var t=null;switch(typeof window[e]){case"string":t=_jsonize(e);break;case"array":default:t=window[e]}return t},_parseDataKeys=function(e,t,a,n){var o,s=n.cloneNode(!0);switch(_getDataObjectType(window[e])){case"object":for(var r in t)o=_searchDataNodes(e,t,a,s,r);case"array":o=_searchDataNodes(e,window[e][a],a,s,null)}return o},_mutationObserverConfig={subtree:!0,attributes:!0,characterData:!0,characterDataOldValue:!0},_bindAttributes=function(e,t,a){for(var n=e.attributes,o=n.length-1;o>=0;o--){n[o].value=="--"+t+"--"&&e.setAttribute(n[o].name,a)}},_searchDataNodes=function(e,t,a,n,o){return function n(s){for(var r=0;r<s.childNodes.length;r++){var i=s.childNodes[r];if(i.nodeType!==Node.TEXT_NODE&&i.childNodes)n(i);else{var l=i.nodeValue,d=_getDataObjectType(window[e]),u=window[e];switch(d){case"object":if(l.indexOf("--"+o+"--")>-1){i.nodeValue=t[o],_bindAttributes(i.parentElement,o,t[o]);var c=function(t){for(var n=0;n<t.length;n++)u[e][a][o]=i.nodeValue,window[e]=u,console.log(window[e])};new MutationObserver(c).observe(s,_mutationObserverConfig)}break;case"array":var _=l.match("--(.*)--");_&&(_=_[1]),l.indexOf("--"+_+"--")>-1&&(i.nodeValue=window[e][a],_bindAttributes(i.parentElement,_,window[e][a]),new MutationObserver(c=function(t){for(var n=0;n<t.length;n++)u[a]=i.nodeValue,window[e]=u,console.log(window[e])}).observe(s,_mutationObserverConfig))}}}}(n),n},_get_keys=function(e){for(var t in e)"object"==typeof e[t]&&null!==e[t]&&_get_keys(e[t]),_key_list.push(e[t])},_jsonize=function(e){try{return JSON.parse(window[e])}catch(t){return window[e]}},_loadScript=function(e){var t=document.createElement("script");t.type="text/javascript",t.src=e,document.getElementsByTagName("head")[0].appendChild(t)},_runPreloader=function(){var e=document.getElementById("progress_bar"),t=1;e.parentElement.style.display="block";var a=setInterval(function(){t>=100?(clearInterval(a),e.parentElement.style.display="none"):(t++,e.style.width=t+"%")},20)},_dataSnapShotList=[],_init=function(){_registerTemplates(),setTimeout(function(){_getTemplate("contentBody")},500),setTimeout(function(){_renderComponents()},1e3),setTimeout(function(){_runPreloader(),_bindDataValues(),_bindDataLists(),_watchDataModel(),_watchDataValuesModel()},1500),_bindRouter(),_loadScript("components/components.js")};return{wu:_getElement,wijax:_wijax,jsonize:_jsonize,bindDataLists:_bindDataLists,loadScript:_loadScript,setTemplateHolder:_setTemplateHolder,registerComponent:_registerComponent,renderComponents:_renderComponents,init:_init}}(),window.wuObject=new wirup;
